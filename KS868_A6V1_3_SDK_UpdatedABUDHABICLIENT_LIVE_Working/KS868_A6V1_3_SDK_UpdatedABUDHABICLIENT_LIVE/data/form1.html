<div class="container1">

  <div style="text-align: center;font-weight: bold;">
    <span style="width:70%;text-align:center"><span style="color:green">{GlobalWebsiteResponseMessage}</span>
      <span style="color:red">{GlobalWebsiteErrorMessage}</span>

    </span>
  </div>
  <div>

    <div id="divAccountExpired" style="color:red;display:none;font-weight:bold;font-size:20px;">
      Your Account is expired on {cloud_account_expire}. Alarm Events are Not working.
    </div>
    <form class="form1" style="background-color: #DDD;" action="/submit-form1" method="POST"
      click="return verifyform()">
      <table>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Network Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label for="connectionType">Active Connection Type</label></td>
                  <td>
                    <select name="wifi_or_ethernet" id="wifi_or_ethernet" style="width:200px">
                      <option value="1">WiFi</option>
                      <option value="0">Ethernet</option>
                    </select>
                  </td>
                </tr>
                <!-- WiFi Fields -->
                <tr id="wifiFields">
                  <td><label for="wifiSsid">Wifi SSID Name:</label></td>
                  <td><input id="wifi_ssid" style="width:200px" type="text" value='{wifi_ssid}' name="wifi_ssid"></td>
                </tr>
                <tr id="wifiPasswordField">
                  <td><label for="wifiPass">Wifi Password:</label></td>
                  <td><input id="wifi_password" style="width:200px" type="text" value='{wifi_password}'
                      name="wifi_password">
                  </td>
                </tr>
                <tr id="wifiIpField">
                  <td><label for="wifiIp">WiFi IP:</label></td>
                  <td><input id="wifi_ip" style="width:200px" value='{wifi_ip}' name="wifi_ip"></td>
                </tr>

                <tr style="display:none1">
                  <td><label for="ethGateway">Wifi Gateway:</label></td>
                  <td><input id="wifi_gateway" style="width:200px" value='{wifi_gateway}' name="wifi_gateway"></td>
                </tr>
                <tr style="display:none1">
                  <td><label for="ethSubnet">Wifi Subnet:</label></td>
                  <td><input id="wifi_subnet" style="width:200px" value='{wifi_subnet}' name="wifi_subnet"></td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Ethernet Info</div>
              <table>
                <!-- Ethernet Fields -->
                <tr id="ethernetFields" style="display:none1">
                  <td style="width:500px;"><label for="ethIp">Ethernet IP:</label></td>
                  <td><input id="eth_ip" style="width:200px" value='{eth_ip}' name="eth_ip"></td>
                </tr>
                <tr id="ethGatewayField" style="display:none1">
                  <td><label for="ethGateway">Ethernet Gateway:</label></td>
                  <td><input id="eth_gateway" style="width:200px" value='{eth_gateway}' name="eth_gateway"></td>
                </tr>
                <tr id="ethSubnetField" style="display:none1">
                  <td><label for="ethSubnet">Ethernet Subnet:</label></td>
                  <td><input id="eth_subnet" style="width:200px" value='{eth_subnet}' name="eth_subnet"></td>
                </tr>
              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Device Info</div>
              <table>
                <tr>
                  <td style="width:500px;"><label for="wifiIp">Device Serial Number:</label></td>
                  <td><input readonly id="device_serial_number" style="width:200px;font-weight:bold"
                      value='{device_serial_number}' name="device_serial_number" /></td>
                </tr>
              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Server Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label for="serverURL">Server API URL:</label></td>
                  <td><input style="width:200px" type="text" id="server_url" name="server_url" value="{server_url}"
                      required />
                  </td>
                </tr>
                <tr>
                  <td><label for="serverURL1">Heartbeat Interval(Seconds):</label></td>
                  <td> <select style="width:200px" name="heartbeat" id="heartbeat" value="{heartbeat}">
                    </select> </td>
                </tr>
                <tr>
                  <td><label for="serverURL3">Socket IP address:</label></td>
                  <td><input style="width:200px" type="text" id="server_ip" name="server_ip" value="{server_ip}"
                      required />
                  </td>
                </tr>
                <tr>
                  <td><label for="serverURL3">Socket Port :</label></td>
                  <td><input style="width:200px" type="text" id="server_port" name="server_port" value="{server_port}"
                      required>
                    <div id="socketConnectionStatus"></div>
                  </td>
                </tr>
              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Temperature Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label for="temp_checkbox">Temperature:</label></td>
                  <td>
                    <label for="temp_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="temp_checkbox" value="1" id="temp_checkbox"
                        onclick="toggleInput('temp_checkbox', 'max_temperature');toggleInput('temp_checkbox', 'min_temperature');toggleTempAlerts();"
                        style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>
                <tr>
                  <td><label for="max_temperature">Max Temperature Threshold (numbers):</label></td>
                  <td><input style="width:200px" type="number" step="0.1" id="max_temperature" name="max_temperature"
                      required disabled>
                  </td>
                </tr>
                <tr>
                  <td><label for="min_temperature">Min Temperature Threshold (numbers):</label></td>
                  <td><input style="width:200px" type="number" step="0.1" id="min_temperature" name="min_temperature"
                      required disabled>
                  </td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Humidity Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label for="humidity_checkbox">Humidity:</label></td>
                  <td>
                    <label for="humidity_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="humidity_checkbox" value="1" id="humidity_checkbox"
                        onclick="toggleInput('humidity_checkbox', 'max_humidity');togglehumidiyAlerts();"
                        style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>
                <tr>
                  <td><label for="max_humidity">Humidity Threshold (numbers):</label></td>
                  <td><input style="width:200px" type="number" step="0.1" id="max_humidity" name="max_humidity" required
                      disabled>
                  </td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Water Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label>Water Leakage:</label></td>
                  <td>
                    <label for="water_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="water_checkbox" value="1" id="water_checkbox"
                        onclick=" toggleWaterAlerts();" style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Fire Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label>Fire:</label></td>
                  <td>
                    <label for="fire_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="fire_checkbox" value="1" id="fire_checkbox" style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Power Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label>Power:</label></td>
                  <td> <label for="power_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="power_checkbox" value="1" id="power_checkbox" style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Door Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label>Door Contact:</label></td>
                  <td>
                    <label for="door_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="door_checkbox" value="1" id="door_checkbox"
                        onclick="toggleInput('door_checkbox', 'max_doorcontact'); " style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>
                <tr>
                  <td><label for="max_doorcontact">Door Contact Waiting(Seconds) :</label></td>
                  <td>
                    <select style="width:200px" name="max_doorcontact" id="max_doorcontact" value="{max_doorcontact}"
                      disabled>
                    </select>
                  </td>
                </tr>

              </table>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="card">
              <div class="card-title">Siren Settings</div>
              <table>
                <tr>
                  <td style="width:500px;"><label for="siren_checkbox">Siren Sound:</label></td>
                  <td>
                    <label for="siren_checkbox" title="SMS"
                      style="cursor: pointer; display: inline-block; width: 200px;">
                      <input type="checkbox" name="siren_checkbox" value="1" id="siren_checkbox"
                        onclick="toggleInput('siren_checkbox', 'max_siren_play'); " style="width:30px">
                      Enable
                    </label>
                  </td>
                </tr>
                <tr>
                  <td><label for="max_siren_play">Siren Play(Seconds) :</label></td>
                  <td>
                    <select style="width:200px" name="max_siren_play" id="max_siren_play" value="{max_siren_play}"
                      disabled>
                    </select>
                  </td>
                </tr>
                <tr>
                  <td style="width:500px;"><label for="max_siren_pause">Siren Pause Time(Seconds) :</label></td>
                  <td>
                    <select style="width:200px" name="max_siren_pause" id="max_siren_pause" value="{max_siren_pause}"
                      disabled>
                    </select>
                  </td>
                </tr>
                <tr>
                  <td></td>
                  <td><input type="submit" value="Update Settings"></td>
                </tr>
              </table>
            </div>
          </td>
        </tr>
      </table>
    </form>
  </div>
</div>
<script>
  function toggleConnectionFields() {
    const connectionType = document.getElementById('wifi_or_ethernet').value;
    const wifiFields = document.getElementById('wifiFields');
    const wifiPasswordField = document.getElementById('wifiPasswordField');
    const wifiIpField = document.getElementById('wifiIpField');
    const ethernetFields = document.getElementById('ethernetFields');
    const ethGatewayField = document.getElementById('ethGatewayField');
    const ethSubnetField = document.getElementById('ethSubnetField');

    if (connectionType === '1') { // WiFi selected
      // wifiFields.style.display = '';
      // wifiPasswordField.style.display = '';
      // wifiIpField.style.display = '';
      // // ethernetFields.style.display = 'none';
      // // ethGatewayField.style.display = 'none';
      // // ethSubnetField.style.display = 'none';
    } else { // Ethernet selected
      // //wifiFields.style.display = 'none';
      // //wifiPasswordField.style.display = 'none';
      // // wifiIpField.style.display = 'none';
      // ethernetFields.style.display = '';
      // ethGatewayField.style.display = '';
      // ethSubnetField.style.display = '';
    }
  }

  // Initialize on page load //document ready
  document.addEventListener('DOMContentLoaded', function () {
    // toggleConnectionFields();



    let selectElement = document.getElementById("heartbeat");
    let options = generateTimeOptionsHeartbeat();

    options.forEach(opt => {
      const optionElement = document.createElement("option");
      optionElement.value = opt.value;
      optionElement.textContent = opt.label;
      selectElement.appendChild(optionElement);
    });

    options = generateTimeOptions();

    selectElement = document.getElementById("max_doorcontact");

    options.forEach(opt => {
      const optionElement = document.createElement("option");
      optionElement.value = opt.value;
      optionElement.textContent = opt.label;
      selectElement.appendChild(optionElement);
    });

    selectElement = document.getElementById("max_siren_play");

    options.forEach(opt => {
      const optionElement = document.createElement("option");
      optionElement.value = opt.value;
      optionElement.textContent = opt.label;
      selectElement.appendChild(optionElement);
    });

    selectElement = document.getElementById("max_siren_pause");

    options.forEach(opt => {
      const optionElement = document.createElement("option");
      optionElement.value = opt.value;
      optionElement.textContent = opt.label;
      selectElement.appendChild(optionElement);
    });
    loadConfigFileData();
  });


  function toggleInput(checkboxId, inputId) {
    document.getElementById(inputId).disabled = !document.getElementById(checkboxId).checked;
    if (!document.getElementById(checkboxId).checked) {
      document.getElementById(inputId).value = '';
    }
  }

</script>

<script>
  function generateTimeOptionsHeartbeat() {
    const options = [];
    const increments = [5, 10, 15, 30]; // Time increments in seconds and minutes

    // Generate options for seconds (5s to 55s)
    for (let sec = 1; sec <= 10; sec += 1) {
      options.push({ id: 'heartbeat', value: sec, label: `${sec} seconds` });
    }


    return options;
  }
  function generateTimeOptions() {
    const options = [];
    const increments = [5, 10, 15, 30]; // Time increments in seconds and minutes

    // Generate options for seconds (5s to 55s)
    for (let sec = 5; sec < 60; sec += 5) {
      options.push({ id: 'heartbeat', value: sec, label: `${sec} seconds` });
    }

    // Generate options for minutes (1 min to 60 min)
    for (let min = 1; min <= 60; min += 1) {
      if (min == 0)
        options.push({ id: 'heartbeat', value: (min + 1) * 60, label: `${(min + 1)} minute${(min + 1) > 1 ? 's' : ''}` });
      else
        options.push({ id: 'heartbeat', value: min * 60, label: `${min} minute${min > 1 ? 's' : ''}` });
    }

    return options;
  }
</script>

<script>
  function loadConfigFileData() {


    const content = document.getElementById("config_json").value;

    console.log(content); // Raw text content
    try {
      const jsonData = JSON.parse(content);
      console.info(jsonData);

      // Access individual properties
      console.info("WiFi SSID:", jsonData.wifi_ssid);
      console.info("Ethernet IP:", jsonData.eth_ip);
      console.info("Server URL:", jsonData.server_url);

      document.getElementById('wifi_ssid').value = jsonData.wifi_ssid == "{wifi_ssid}" ? '' : jsonData.wifi_ssid;
      document.getElementById('wifi_password').value = jsonData.wifi_password == "{wifi_password}" ? '' : jsonData.wifi_password;
      document.getElementById('wifi_ip').value = jsonData.wifi_ip == "{wifi_ip}" ? '' : jsonData.wifi_ip;
      document.getElementById('wifi_or_ethernet').value = jsonData.wifi_or_ethernet == "{wifi_or_ethernet}" ? '' : jsonData.wifi_or_ethernet;

      // document.getElementById('wifi_gateway').value =
      //   (jsonData.wifi_gateway === "{wifi_gateway}" || jsonData.wifi_gateway === "undefined") ? '' : jsonData.wifi_gateway;

      // document.getElementById('wifi_subnet').value =
      //   (jsonData.wifi_subnet === "{wifi_subnet}" || jsonData.wifi_subnet === "undefined") ? '' : jsonData.wifi_subnet;
      document.getElementById('wifi_gateway').value = jsonData.wifi_gateway || "";
      document.getElementById('wifi_subnet').value = jsonData.wifi_subnet || "";


      document.getElementById('eth_ip').value = jsonData.eth_ip == "{eth_ip}" ? '' : jsonData.eth_ip;
      document.getElementById('eth_gateway').value = jsonData.eth_gateway == "{eth_gateway}" ? '' : jsonData.eth_gateway;
      document.getElementById('eth_subnet').value = jsonData.eth_subnet == "{eth_subnet}" ? '' : jsonData.eth_subnet;

      document.getElementById('device_serial_number').value = jsonData.device_serial_number == "{device_serial_number}" ? '' : jsonData.device_serial_number;


      document.getElementById('server_url').value = jsonData.server_url == "{server_url}" ? '' : jsonData.server_url;
      document.getElementById('heartbeat').value = jsonData.heartbeat == "{heartbeat}" ? '' : jsonData.heartbeat;
      document.getElementById('server_ip').value = jsonData.server_ip == "{server_ip}" ? '' : jsonData.server_ip;
      document.getElementById('server_port').value = jsonData.server_port == "{server_port}" ? '' : jsonData.server_port;

      document.getElementById('min_temperature').value = jsonData.min_temperature == "{min_temperature}" ? '' : jsonData.min_temperature;
      document.getElementById('max_temperature').value = jsonData.max_temperature == "{max_temperature}" ? '' : jsonData.max_temperature;


      document.getElementById('max_humidity').value = jsonData.max_humidity == "{max_humidity}" ? '' : jsonData.max_humidity;


      document.getElementById('max_doorcontact').value = jsonData.max_doorcontact == "{max_doorcontact}" ? '' : jsonData.max_doorcontact;
      document.getElementById('max_siren_play').value = jsonData.max_siren_play == "{max_siren_play}" ? '' : jsonData.max_siren_play;
      document.getElementById('max_siren_pause').value = jsonData.max_siren_pause == "{max_siren_pause}" ? '' : jsonData.max_siren_pause;

      document.getElementById('temp_checkbox').checked = jsonData.temp_checkbox;
      document.getElementById('water_checkbox').checked = jsonData.water_checkbox;
      document.getElementById('fire_checkbox').checked = jsonData.fire_checkbox;
      document.getElementById('power_checkbox').checked = jsonData.power_checkbox;
      document.getElementById('door_checkbox').checked = jsonData.door_checkbox;
      document.getElementById('siren_checkbox').checked = jsonData.siren_checkbox;
      document.getElementById('humidity_checkbox').checked = jsonData.humidity_checkbox;


      toggleInput('temp_checkbox', 'max_temperature');
      toggleInput('temp_checkbox', 'min_temperature')
      toggleInput('siren_checkbox', 'max_siren_play');
      toggleInput('siren_checkbox', 'max_siren_pause');
      toggleInput('door_checkbox', 'max_doorcontact');
      toggleInput('humidity_checkbox', 'max_humidity');



      toggleConnectionFields();
      // toggleDoorAlerts();
      // toggleFireAlerts();

      // togglePowerAlerts();
      // toggleTempAlerts();
      // toggleWaterAlerts();
      // togglehumidiyAlerts();


      if (jsonData.cloudAccountActiveDaysRemaining <= 0) {
        alert("Your Account is Expired. Contact Service Provider.");

        document.getElementById("divAccountExpired").style.display = "block";
      }
      else
        if (jsonData.cloudAccountActiveDaysRemaining < 30) {
          alert("Your Account will expire in " + jsonData.cloudAccountActiveDaysRemaining + " days and De-Activate Alarm Events automatically");
        }


    } catch (error) {
      console.error("Error parsing JSON:", error);
    }

  }
  function verifyform() {

    if (document.getElementById('temp_checkbox').checked) {
      let min_temperature = document.getElementById('min_temperature').value;
      let max_temperature = document.getElementById('max_temperature').value;

      min_temperature = parseFloat(min_temperature);
      if (isNaN(min_temperature)) {
        alert("Invalid Temperature Value")
        return false;
      }

    }
    alert("Ok")
    return true;


    return false; // Allow submission
  }
</script>

</div>
</body>

</html>